<div class="row">
  <div class="col-sm-10">
    <span class="h2"><%= @course.courseName %>
      <small><%= @course.courseDesc %></small></span>
  </div>
  <% if admin? %>
      <div class="col-sm-2" align="right">
        <%= link_to "Edit Course", edit_course_path(@course) %><br>
        <%= link_to "Delete Course", @course, method: :delete, data: {confirm: "Are you sure you want to delete this course?"} %>
      </div>
  <% end %>
</div>
<br>
<div class="panel panel-default">
  <!-- Default panel contents -->
  <div class="panel-heading">Course Offerings</div>

  <table id="offerings" class="table">
    <thead>
    <tr>
      <th>Date</th>
      <th>Notes</th>
      <th>Price</th>
      <th>
        <% if admin? %>
            Admin
        <% else %>
            Registration
        <% end %>
      </th>
    </tr>
    </thead>
    <tbody>
    <% @offerings.each do |offering| %>
        <tr>
          <td><%= offering.courseDate %></td>
          <td><%= offering.courseNotes %></td>
          <td><%= number_to_currency(offering.coursePrice) %></td>
          <td>
            <% if admin? %>
                <%= link_to "Edit Offering", edit_offering_path(offering) %>
                |
                <%= link_to "Delete Offering", offering, method: :delete, data: {confirm: "Are you sure you want to delete this offering?"} %>
            <% elsif session[:user_id] %>
                <% if @registered_offering_ids.include? offering.id %>
                    You have registered for this course offering.
                <% else %>
                    <%= link_to "Click here to register!", rosters_path(roster: {user_id: session[:user_id], offering_id: offering.id}), method: :post %>
                <% end %>
            <% else %>
                Log in to register!
            <% end %>
          </td>
        </tr>
    <% end %>
    </tbody>
    <% if admin? %>
        <tfoot>
        <tr>
          <td colspan="4" align="center">
            <%= link_to "Add New Offering", new_offering_path(course_id: @course), class: 'btn btn-default btn-primary', role: 'button' %>
          </td>
        </tr>
        </tfoot>
    <% end %>
  </table>
</div>
